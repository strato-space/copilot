{
  "assessments": {
    "abstraction_fitness": {
      "score": 56.8,
      "components": [
        "Abstraction Leverage",
        "Indirection Cost",
        "Interface Honesty"
      ],
      "component_scores": {
        "Abstraction Leverage": 67.5,
        "Indirection Cost": 74.7,
        "Interface Honesty": 77.9
      }
    },
    "ai_generated_debt": 78.7,
    "api_surface_coherence": 52.3,
    "authorization_consistency": 65.8,
    "convention_outlier": 67.4,
    "cross_module_architecture": 66.4,
    "design_coherence": 51.7,
    "error_consistency": 61.3,
    "high_level_elegance": 60.6,
    "incomplete_migration": 56.5,
    "low_level_elegance": 65.0,
    "mid_level_elegance": 55.2,
    "package_organization": 52.8
  },
  "dimension_notes": {
    "cross_module_architecture": {
      "evidence": [
        "`app/src/store/requestStore.ts` binds UI state (`loading`, `error`) to transport execution (`axios.post`) and environment/runtime discovery (`window.backend_url`, `window.proxy_url`, `window.proxy_auth`) in the same store module.",
        "The request path assembly (`${backendUrl}/${url}`) and proxy header protocol (`X-Proxy-Auth`, `X-Proxy-Target-URL`) are embedded directly inside shared store actions, creating a central coupling point between unrelated feature callers and deployment/runtime concerns."
      ],
      "impact_scope": "subsystem",
      "fix_scope": "multi_file_refactor",
      "confidence": "high",
      "issues_preventing_higher_score": ""
    },
    "high_level_elegance": {
      "evidence": [
        "`crmStore.ts` defines many unrelated slices (reports, editing, tree, forms, filters, comments/hours, Figma sync, section selection, metrics, bot command, additional filters) under one store export, so top-level ownership is not crisp.",
        "`authStore.ts` combines transport calls (`/auth/me`, `/try_login`, `/auth_token`, `/logout`), cookie/localStorage persistence, and auth state transitions in one module, blending infrastructure and domain roles.",
        "`codexTaskTimeline.ts` being in `store/` but implemented as utility logic reduces decomposition clarity: folder naming suggests state ownership while file behavior is pure transformation."
      ],
      "impact_scope": "subsystem",
      "fix_scope": "architectural_change",
      "confidence": "high",
      "issues_preventing_higher_score": ""
    },
    "abstraction_fitness": {
      "evidence": [
        "`getBackendUrl/getProxyConfig` logic is duplicated in `permissionsStore.ts` and `requestStore.ts`, while similar runtime resolution already exists in `voicebotRuntimeConfig.ts`.",
        "`sessionsUIStore.ts` re-implements MCP URL resolution and transcription text extraction inside `generateSessionTitle` instead of reusing existing helpers (`voicebotRuntimeConfig.resolveAgentsMcpServerUrl`, `buildTranscriptionText` in `voiceBotStore.ts`).",
        "`sessionsUIStore.ts` contains near-duplicate actions (`setTicketsModalSelectedIds` and `setSelectedTicketIds`) and overlapping edit-commit actions (`saveTicketEdit` and `saveEditingTicket`), indicating abstraction drift."
      ],
      "impact_scope": "subsystem",
      "fix_scope": "multi_file_refactor",
      "confidence": "high",
      "issues_preventing_higher_score": "",
      "sub_axes": {
        "abstraction_leverage": 68.0,
        "indirection_cost": 71.0,
        "interface_honesty": 77.0
      }
    },
    "mid_level_elegance": {
      "evidence": [
        "`voiceBotStore.ts` mixes `voicebotHttp.request` with direct `axios`/`fetch` calls for upload/download flows, creating multiple integration seams with different behavior.",
        "`permissionsStore.ts` uses `voicebot/...` endpoints for most operations but `getUserPermissions` calls `permissions/users/permissions` (without `voicebot/`), making boundary contracts inconsistent within one module.",
        "`kanbanStore.ts` request payload key typo (`satuses`) in `fetchTickets` undermines the request seam and can silently break filtering behavior."
      ],
      "impact_scope": "subsystem",
      "fix_scope": "multi_file_refactor",
      "confidence": "high",
      "issues_preventing_higher_score": ""
    },
    "low_level_elegance": {
      "evidence": [
        "`kanbanStore.ts` keeps a very large inline transformer (`transformPaymentsTreeToTreeData`) nested inside an async action, with deep loops and mixed concerns (mapping + key building + UI shape), reducing local readability and testability.",
        "`kanbanStore.ts` exposes `deleteIncomeRow` as a no-op TODO while keeping it in the public store API, leaving dead behavior on an active interface.",
        "`sessionsUIStore.ts` keeps duplicated action internals and overlapping ticket-edit state mutations, increasing local cognitive load and divergence risk."
      ],
      "impact_scope": "module",
      "fix_scope": "multi_file_refactor",
      "confidence": "high",
      "issues_preventing_higher_score": ""
    },
    "api_surface_coherence": {
      "evidence": [
        "`permissionsStore.ts` mixes endpoint families (`voicebot/permissions/...` vs `permissions/users/permissions`) for similar operations.",
        "`kanbanStore.ts` sends `satuses` instead of `statuses` in ticket list payload, while related state and methods use `status`/`statuses` naming.",
        "Store APIs expose mixed naming/protocols (`setTicketsModalSelectedIds` and `setSelectedTicketIds` both public, same effect)."
      ],
      "impact_scope": "subsystem",
      "fix_scope": "multi_file_refactor",
      "confidence": "high",
      "issues_preventing_higher_score": ""
    },
    "package_organization": {
      "evidence": [
        "Holistic structure data shows `app/src/store/` has 20 files (threshold breach for flat directory overload) with mixed concerns and low cohesion signals (`avg_fan_in: 0.7`, `avg_fan_out: 1.8`).",
        "`app/src/store/codexTaskTimeline.ts` is a pure stateless helper object (no Zustand state) and has a single importer (`app/src/store/voiceBotStore.ts`), indicating placement mismatch with store ownership.",
        "`app/src/store/crmStore.ts` bundles CRM UI state, Figma sync orchestration, metrics filters, bot command editing state, and cookie persistence in one package file, making directory boundaries weak."
      ],
      "impact_scope": "subsystem",
      "fix_scope": "multi_file_refactor",
      "confidence": "high",
      "issues_preventing_higher_score": ""
    },
    "design_coherence": {
      "evidence": [
        "Voice worker handlers repeat the same end-to-end processor lifecycle (ID validation, DB fetch, OpenAI call, processors_data state updates, success/error logging) across `customPrompt.ts`, `questionsHandler.ts`, `oneCustomPrompt.ts`, and `finalizationHandler.ts` with only prompt/model/target differences.",
        "Task payload normalization is duplicated across backend and frontend (`normalizeTask` in `createTasksFromChunks.ts` and `parseTask` in `PossibleTasks.tsx`) including the same legacy key fallbacks (`Task ID`, `Task Title`, `Description`, `Priority`, `Priority Reason`, `Dependencies`, `Dialogue Reference`).",
        "Identifier/link normalization helpers are reimplemented in multiple places (`toLookupValue` in `taskPageUtils.ts` and `CRMKanban.tsx`, plus message/link normalization functions in `ingressHandlers.ts`), creating parallel normalization dialects.",
        "Large UI modules combine unrelated responsibilities: `SessionPage.tsx` handles data loading + error mapping + clipboard image transformation/upload orchestration + tab policy; `SessionsListPage.tsx` combines URL/state serialization, filter parsing, identity normalization, and table/action UI."
      ],
      "impact_scope": "subsystem",
      "fix_scope": "multi_file_refactor",
      "confidence": "high",
      "issues_preventing_higher_score": ""
    },
    "convention_outlier": {
      "evidence": [
        "app/src/store/permissionsStore.ts mixes endpoint prefixes in the same module: most calls use `voicebot/permissions/...` but `getUserPermissions` calls `permissions/users/permissions`.",
        "backend/src/api/routes/crm/index.ts mounts mixed naming styles (`/taskTypes`, `/project_groups`, `/project_tree`) in one surface, indicating unresolved protocol conventions.",
        "app/src/store/requestStore.ts and backend/src/api/routes/crm/uploads.ts disagree on upload response shape conventions (string URL vs object payload)."
      ],
      "impact_scope": "subsystem",
      "fix_scope": "multi_file_refactor",
      "confidence": "high",
      "issues_preventing_higher_score": ""
    },
    "error_consistency": {
      "evidence": [
        "app/src/store/requestStore.ts rethrows API errors (`throw error`), while app/src/store/permissionsStore.ts frequently catches and suppresses failures after toast/setState, creating inconsistent caller behavior.",
        "app/src/store/permissionsStore.ts `getUserPermissions` catches all errors and returns `[]`, which conflates transport failure with 'no permissions' state.",
        "app/src/store/voiceBotStore.ts has many catch blocks that only log and continue, while other actions throw, so consumers cannot rely on consistent failure semantics."
      ],
      "impact_scope": "subsystem",
      "fix_scope": "multi_file_refactor",
      "confidence": "high",
      "issues_preventing_higher_score": ""
    },
    "authorization_consistency": {
      "evidence": [
        "backend/src/index.ts mounts `/api/crm` directly without a global auth guard.",
        "backend/src/api/routes/crm/customers.ts and backend/src/api/routes/crm/uploads.ts expose mutating/listing routes without `authMiddleware` or role checks.",
        "In contrast, backend/src/api/routes/finops/employees.ts explicitly applies `authMiddleware`, showing sibling-domain inconsistency in access control posture."
      ],
      "impact_scope": "codebase",
      "fix_scope": "architectural_change",
      "confidence": "high",
      "issues_preventing_higher_score": ""
    },
    "ai_generated_debt": {
      "evidence": [
        "app/src/store/voiceBotStore.ts contains a high volume of repetitive `try/catch + console.error + message` blocks with near-identical structure.",
        "app/src/store/permissionsStore.ts repeats similar catch/toast boilerplate for each action instead of centralized request/error policy.",
        "app/src/store/requestStore.ts includes generic failure strings (`Failed to fetch! Try again.`/`Failed to send! Try again.`) that discard structured backend error details."
      ],
      "impact_scope": "subsystem",
      "fix_scope": "multi_file_refactor",
      "confidence": "medium",
      "issues_preventing_higher_score": ""
    },
    "incomplete_migration": {
      "evidence": [
        "backend/src/api/routes/crm/index.ts still mounts multiple `legacy/*` routers as active first-class API endpoints.",
        "backend/src/api/routes/crm/legacy/botcommands.ts contains an explicit migration stub (`TODO: Implement actual command testing logic`) but is called by app/src/store/kanbanStore.ts `testBotCommand`.",
        "app/src/store/requestStore.ts still advertises migration origin and old assumptions (string upload return), while backend/src/api/routes/crm/uploads.ts now returns structured objects."
      ],
      "impact_scope": "subsystem",
      "fix_scope": "multi_file_refactor",
      "confidence": "high",
      "issues_preventing_higher_score": ""
    }
  },
  "findings": [
    {
      "dimension": "cross_module_architecture",
      "identifier": "runtime_transport_ui_coupling_in_store",
      "summary": "Request store is a cross-boundary hub for UI state, runtime config, and transport protocol.",
      "related_files": [
        "app/src/store/requestStore.ts",
        ".desloppify/review_packet_blind.json"
      ],
      "evidence": [
        "The same Zustand store action resolves runtime globals (`window.backend_url`, proxy settings), constructs transport headers, performs network I/O, and mutates shared UI state (`loading`, `error`).",
        "Holistic context flags this module in coupling analysis and marks it as an indirection hotspot, matching the code-level boundary mixing."
      ],
      "suggestion": "Extract runtime URL/proxy resolution and HTTP transport into a dedicated service module (e.g., `services/requestClient.ts`), keep `requestStore` limited to request state orchestration, and inject/call the service from store actions to restore dependency direction.",
      "confidence": "high",
      "impact_scope": "subsystem",
      "fix_scope": "multi_file_refactor",
      "root_cause_cluster": "boundary_blur_store_as_integration_hub"
    },
    {
      "dimension": "high_level_elegance",
      "identifier": "store_ownership_is_mixed_and_legacy_shaped",
      "summary": "Module ownership is blurred by legacy-shaped API and mixed responsibilities.",
      "related_files": [
        "app/src/store/requestStore.ts",
        ".desloppify/review_packet_blind.json"
      ],
      "evidence": [
        "File-level comment indicates migration from legacy appkanban store, and the exported surface keeps legacy naming (`api_request`) while also owning transport mechanics and proxy behavior.",
        "The store exposes one global `loading/error` state for all requests, so unrelated feature flows implicitly share and contend for the same operational state."
      ],
      "suggestion": "Split responsibilities into (1) a transport client with explicit methods and config, and (2) a thin store concerned only with UI request status per domain or per call key; rename public actions to current naming conventions (`apiRequest`) during the refactor to align ownership and intent.",
      "confidence": "medium",
      "impact_scope": "module",
      "fix_scope": "multi_file_refactor",
      "root_cause_cluster": "boundary_blur_store_as_integration_hub"
    },
    {
      "dimension": "abstraction_fitness",
      "identifier": "runtime_config_duplication_drift",
      "summary": "Runtime URL/proxy resolution is duplicated across stores instead of using one shared abstraction.",
      "related_files": [
        "app/src/store/permissionsStore.ts",
        "app/src/store/requestStore.ts",
        "app/src/store/voicebotRuntimeConfig.ts"
      ],
      "evidence": [
        "`permissionsStore.ts` defines local `getBackendUrl/getProxyConfig` (lines 35-51).",
        "`requestStore.ts` defines another local `getBackendUrl/getProxyConfig` pair (lines 22-46).",
        "`voicebotRuntimeConfig.ts` already provides equivalent runtime/proxy helpers but is not used by those stores."
      ],
      "suggestion": "Extract and enforce a single runtime transport config source (e.g., extend `voicebotRuntimeConfig` or a generic `runtimeHttpConfig`) and migrate both stores to consume it; add a small contract test to prevent config divergence.",
      "confidence": "high",
      "impact_scope": "subsystem",
      "fix_scope": "multi_file_refactor",
      "root_cause_cluster": "missing_shared_transport_boundary"
    },
    {
      "dimension": "mid_level_elegance",
      "identifier": "transport_seam_inconsistency_voice_store",
      "summary": "Voice store mixes transport paths (`voicebotHttp`, raw `axios`, raw `fetch`) with inconsistent boundary behavior.",
      "related_files": [
        "app/src/store/voiceBotStore.ts",
        "app/src/store/voicebotRuntimeConfig.ts",
        "app/src/store/permissionsStore.ts"
      ],
      "evidence": [
        "`voiceBotStore.ts` uses `voicebotHttp.request(...)` for most endpoints but switches to direct `axios.post` for `uploadAudioFile`/`uploadSessionImageAttachment` (lines 1330-1372) and raw `fetch` for `downloadTranscription` (line 1627+).",
        "Direct calls build headers/backend URL manually and bypass shared request behavior (proxy handling and centralized conventions).",
        "`permissionsStore.ts` explicitly supports proxy mode in `voicebotRequest`, showing seam expectations differ across stores."
      ],
      "suggestion": "Route upload/download through a single typed transport layer (extend `voicebotHttp` with multipart and blob download helpers) so auth/proxy/error semantics are uniform.",
      "confidence": "high",
      "impact_scope": "subsystem",
      "fix_scope": "multi_file_refactor",
      "root_cause_cluster": "missing_shared_transport_boundary"
    },
    {
      "dimension": "mid_level_elegance",
      "identifier": "permissions_endpoint_contract_drift",
      "summary": "One permissions call uses a different endpoint namespace, creating an inconsistent API seam within the same store.",
      "related_files": [
        "app/src/store/permissionsStore.ts",
        "app/src/store/voicebotRuntimeConfig.ts"
      ],
      "evidence": [
        "Most requests target `voicebot/permissions/...` (e.g., lines 93, 111, 124, 142, 165, 182, 213, 233).",
        "`getUserPermissions` calls `permissions/users/permissions` (line 200) without the `voicebot/` prefix."
      ],
      "suggestion": "Normalize all permissions endpoints behind a typed endpoint map and use one namespace source (`voicebot/permissions/...`) to avoid seam-level drift.",
      "confidence": "high",
      "impact_scope": "module",
      "fix_scope": "single_edit",
      "root_cause_cluster": "missing_shared_transport_boundary"
    },
    {
      "dimension": "low_level_elegance",
      "identifier": "kanban_fetch_filter_payload_typo",
      "summary": "Ticket fetch sends a misspelled payload key (`satuses`), making filter behavior fragile.",
      "related_files": [
        "app/src/store/kanbanStore.ts",
        "app/src/store/crmStore.ts",
        "app/src/store/requestStore.ts"
      ],
      "evidence": [
        "`kanbanStore.ts` `fetchTickets` sends `{ satuses: statuses }` at line 300.",
        "Store-level status filtering is central (`statusesFilter` in `kanbanStore.ts` and CRM status workflows in `crmStore.ts`), so this typo can silently desynchronize UI intent from API behavior."
      ],
      "suggestion": "Correct the payload key to `statuses`, add a typed request DTO for ticket list queries, and add a regression test that asserts status filters are transmitted correctly.",
      "confidence": "high",
      "impact_scope": "module",
      "fix_scope": "single_edit",
      "root_cause_cluster": "untyped_request_contracts"
    },
    {
      "dimension": "low_level_elegance",
      "identifier": "kanban_nested_transformer_complexity",
      "summary": "A large nested tree-conversion function inside store action creates high local complexity and weak test seams.",
      "related_files": [
        "app/src/store/kanbanStore.ts",
        "app/src/store/crmStore.ts"
      ],
      "evidence": [
        "`transformPaymentsTreeToTreeData` is declared inline inside `fetchPerformersPaymentsTree` (starting line 1163) with multiple nested loops and shape conversions.",
        "The same store also keeps UI orchestration/state updates and finance calculations, so this dense transformation compounds local complexity in one module."
      ],
      "suggestion": "Extract payments-tree normalization into a pure utility module with typed input/output and dedicated tests; keep the store action limited to orchestration and state assignment.",
      "confidence": "high",
      "impact_scope": "module",
      "fix_scope": "multi_file_refactor",
      "root_cause_cluster": "overgrown_store_modules"
    },
    {
      "dimension": "abstraction_fitness",
      "identifier": "sessionsui_duplicate_action_surface",
      "summary": "Sessions UI store exposes duplicated and overlapping ticket-edit actions, indicating abstraction debt.",
      "related_files": [
        "app/src/store/sessionsUIStore.ts",
        "app/src/store/voiceBotStore.ts"
      ],
      "evidence": [
        "`setTicketsModalSelectedIds` and `setSelectedTicketIds` perform the same update path (lines 417-420).",
        "`saveTicketEdit` merges and clears edits (lines 449-472), while `saveEditingTicket` separately writes from `editingTickets` to `savedChanges` (lines 511-519), creating overlapping commit semantics.",
        "`generateSessionTitle` duplicates MCP URL and transcription text assembly logic that already exists in voice-related store utilities."
      ],
      "suggestion": "Consolidate ticket-edit actions into one explicit edit-state state machine (`draft -> committed -> reset`) and move shared title-generation preprocessing to reusable helpers consumed by both stores.",
      "confidence": "medium",
      "impact_scope": "module",
      "fix_scope": "multi_file_refactor",
      "root_cause_cluster": "overgrown_store_modules"
    },
    {
      "dimension": "api_surface_coherence",
      "identifier": "auth_response_shape_dual_contract",
      "summary": "Auth store accepts two incompatible response shapes instead of enforcing one API contract.",
      "related_files": [
        "app/src/store/authStore.ts",
        "app/src/services/api.ts"
      ],
      "evidence": [
        "`extractUserFromResponse` reads both `data.user`/`data.auth_token` and top-level `user`/`auth_token` (app/src/store/authStore.ts:81-89).",
        "All auth calls use the shared `apiClient`, so contract normalization is a cross-boundary concern rather than an isolated call-site quirk (app/src/services/api.ts:6-9, app/src/store/authStore.ts:103,124,151,181)."
      ],
      "suggestion": "Define a single typed auth response schema for `/auth/me`, `/try_login`, and `/auth_token` and normalize once in the API layer (or backend), then remove fallback extraction branches from `authStore`.",
      "confidence": "high",
      "impact_scope": "subsystem",
      "fix_scope": "multi_file_refactor",
      "root_cause_cluster": "auth_contract_drift"
    },
    {
      "dimension": "api_surface_coherence",
      "identifier": "mixed_token_transport_contract",
      "summary": "Auth token handling mixes cookie session semantics with localStorage token semantics.",
      "related_files": [
        "app/src/store/authStore.ts",
        "app/src/services/api.ts"
      ],
      "evidence": [
        "Axios clients are configured with `withCredentials: true`, which implies cookie-based auth transport (app/src/services/api.ts:6-14).",
        "`authStore` still reads/writes token from/to localStorage (`VOICEBOT_AUTH_TOKEN`) and manually sets `auth_token` cookie from JS (app/src/store/authStore.ts:45-70)."
      ],
      "suggestion": "Choose one client auth contract for this surface (prefer cookie-only if backend is cookie-auth) and remove localStorage token fallback/write paths plus JS-managed `auth_token` cookie writes.",
      "confidence": "high",
      "impact_scope": "subsystem",
      "fix_scope": "architectural_change",
      "root_cause_cluster": "auth_contract_drift"
    },
    {
      "dimension": "mid_level_elegance",
      "identifier": "inconsistent_401_cleanup_path",
      "summary": "Equivalent unauthorized outcomes trigger different client cleanup behavior.",
      "related_files": [
        "app/src/store/authStore.ts",
        "app/src/services/api.ts"
      ],
      "evidence": [
        "`checkAuth` on 401 clears persisted auth artifacts via `clearAuthCookies()` before updating state (app/src/store/authStore.ts:113-116).",
        "`refreshUserData` on 401 updates Zustand state but does not clear persisted cookie/localStorage values (app/src/store/authStore.ts:208-218), leaving divergent side effects for the same failure class."
      ],
      "suggestion": "Centralize unauthorized handling into one helper used by all auth actions, ensuring state reset and persistence cleanup are deterministic for every 401 path.",
      "confidence": "high",
      "impact_scope": "module",
      "fix_scope": "multi_file_refactor",
      "root_cause_cluster": "auth_state_transition_drift"
    },
    {
      "dimension": "mid_level_elegance",
      "identifier": "ready_flag_transition_drift",
      "summary": "Login success path omits readiness transition used by other auth flows.",
      "related_files": [
        "app/src/store/authStore.ts",
        "app/src/services/api.ts"
      ],
      "evidence": [
        "`tryLogin` success sets auth/user/permissions/token but not `ready` (app/src/store/authStore.ts:129-137).",
        "Other auth-success/finalization flows consistently set `ready: true` (`checkAuth`, `tryTokenAuth`, `refreshUserData`, `logout`) at app/src/store/authStore.ts:107,161,191,241."
      ],
      "suggestion": "Introduce a shared `setAuthenticatedState` transition (including `ready`) and use it across all successful auth paths to prevent lifecycle divergence.",
      "confidence": "high",
      "impact_scope": "module",
      "fix_scope": "single_edit",
      "root_cause_cluster": "auth_state_transition_drift"
    },
    {
      "dimension": "package_organization",
      "identifier": "store_flattening_mixed_concerns",
      "summary": "`app/src/store` is overloaded with mixed responsibilities, weakening package boundaries.",
      "related_files": [
        "app/src/store/crmStore.ts",
        "app/src/store/authStore.ts",
        "app/src/store/codexTaskTimeline.ts"
      ],
      "evidence": [
        "Holistic context flags `app/src/store/` as flat with 20 files and mixed imports across services/types/utils/constants.",
        "`crmStore.ts` includes CRM UI, Figma sync, bot-command editing, and finance-month selectors in one store module.",
        "`authStore.ts` and `codexTaskTimeline.ts` sit beside domain stores despite serving cross-cutting auth infra and pure timeline utility roles."
      ],
      "suggestion": "Staged reorg plan: 1) create `app/src/store/auth/`, `app/src/store/crm/`, and `app/src/utils/voice/`; 2) move `authStore.ts` to `store/auth/authStore.ts`, `crmStore.ts` to `store/crm/crmUIStore.ts`, `codexTaskTimeline.ts` to `utils/voice/codexTaskTimeline.ts`; 3) update imports with `rg -n \"authStore|crmStore|codexTaskTimeline\" app/src` and replace paths; 4) run `cd app && npm run build` and `cd app && npm run test` to validate module moves.",
      "confidence": "high",
      "impact_scope": "subsystem",
      "fix_scope": "multi_file_refactor",
      "root_cause_cluster": "store_boundary_erosion"
    },
    {
      "dimension": "high_level_elegance",
      "identifier": "crm_store_acts_as_multiple_subsystems",
      "summary": "`crmStore.ts` acts as an omnibus module instead of a coherent bounded store.",
      "related_files": [
        "app/src/store/crmStore.ts",
        "app/src/store/kanbanStore.ts",
        "app/src/components/crm/CRMKanban.tsx"
      ],
      "evidence": [
        "`crmStore.ts` exposes unrelated domains in one top-level API (`setPairToSync`, `getSectionsToSync`, `setMetricMonth`, `setSelectedBotCommand`, `saveFilters`).",
        "Consumers across CRM and Kanban paths depend on this shared omnibus surface, increasing ripple risk for unrelated changes.",
        "Prior packet context already flagged `crmStore.ts` for structural smells; current code still keeps the same multi-domain shape."
      ],
      "suggestion": "Staged decomposition plan: 1) extract slices into `store/crm/uiFiltersStore.ts`, `store/crm/editingStore.ts`, `store/crm/figmaSyncStore.ts`, `store/crm/metricsStore.ts`, `store/crm/botCommandStore.ts`; 2) add a compatibility barrel `store/crm/index.ts` that re-exports hooks temporarily; 3) migrate call sites incrementally (start with CRM components, then `kanbanStore.ts`); 4) remove deprecated exports after import migration; 5) validate with `cd app && npm run build` and targeted grep `rg -n \"useCRMStore\" app/src`.",
      "confidence": "high",
      "impact_scope": "subsystem",
      "fix_scope": "architectural_change",
      "root_cause_cluster": "store_boundary_erosion"
    },
    {
      "dimension": "high_level_elegance",
      "identifier": "auth_store_blends_domain_and_infra",
      "summary": "`authStore.ts` mixes auth state ownership with storage and transport infrastructure.",
      "related_files": [
        "app/src/store/authStore.ts",
        "app/src/services/api.ts",
        "app/src/hooks/useUserRefresh.ts"
      ],
      "evidence": [
        "`authStore.ts` directly handles cookie/localStorage read-write (`readCookieToken`, `saveAuthToCookies`, `clearAuthCookies`) and API calls in the same module.",
        "This makes `authStore` both a state container and persistence/transport adapter, reducing role clarity and making future auth transport changes invasive.",
        "High importer count for `authStore.ts` amplifies this ownership blur across pages, hooks, and other stores."
      ],
      "suggestion": "Staged boundary cleanup: 1) move persistence helpers to `app/src/services/auth/authPersistence.ts`; 2) move HTTP interactions to `app/src/services/auth/authApi.ts`; 3) keep `authStore.ts` as orchestration/state only and inject the service helpers; 4) update imports via `rg -n \"readCookieToken|saveAuthToCookies|clearAuthCookies|/auth/me|/try_login\" app/src`; 5) validate with `cd app && npm run build` and smoke-check login/session flows.",
      "confidence": "high",
      "impact_scope": "subsystem",
      "fix_scope": "multi_file_refactor",
      "root_cause_cluster": "store_boundary_erosion"
    },
    {
      "dimension": "package_organization",
      "identifier": "utility_misplaced_in_store_package",
      "summary": "`codexTaskTimeline.ts` is a utility but is packaged as a store module.",
      "related_files": [
        "app/src/store/codexTaskTimeline.ts",
        "app/src/store/voiceBotStore.ts",
        "app/src/utils/voiceTimeline.ts"
      ],
      "evidence": [
        "`codexTaskTimeline.ts` exports pure conversion/sorting functions and no Zustand state.",
        "It has one importer (`voiceBotStore.ts`), indicating feature-local utility affinity rather than shared store ownership.",
        "`app/src/utils/voiceTimeline.ts` already exists, showing the codebase has a voice utility namespace where this logic fits better."
      ],
      "suggestion": "Staged move plan: 1) move file to `app/src/utils/voice/codexTaskTimeline.ts`; 2) update `voiceBotStore.ts` import to `../utils/voice/codexTaskTimeline`; 3) search residual paths with `rg -n \"codexTaskTimeline\" app/src`; 4) run `cd app && npm run build` to verify path updates.",
      "confidence": "high",
      "impact_scope": "module",
      "fix_scope": "single_edit",
      "root_cause_cluster": "store_boundary_erosion"
    },
    {
      "dimension": "design_coherence",
      "identifier": "voice_processor_lifecycle_duplication",
      "summary": "Voice processor handlers duplicate the same orchestration skeleton instead of sharing a processor pipeline abstraction.",
      "related_files": [
        "backend/src/workers/voicebot/handlers/customPrompt.ts",
        "backend/src/workers/voicebot/handlers/questionsHandler.ts",
        "backend/src/workers/voicebot/handlers/oneCustomPrompt.ts",
        "backend/src/workers/voicebot/handlers/finalizationHandler.ts"
      ],
      "evidence": [
        "`customPrompt.ts` and `questionsHandler.ts` both do message/session fetch, categorization gating, OpenAI call, and near-identical processors_data success/error state writes.",
        "`oneCustomPrompt.ts` and `finalizationHandler.ts` repeat the same session-level version of the pattern (validate, fetch session, collect input rows, OpenAI call, mark processor flags, clear/set error fields).",
        "Error-state fields and success flags (`is_processing`, `is_processed`, `error`, `error_message`, timestamps) are manually duplicated, increasing drift risk in retry/telemetry semantics."
      ],
      "suggestion": "Introduce a shared processor executor (template method) that centralizes lifecycle steps (load target, preconditions, run model call, normalize output, persist status, emit logs/events), and keep each handler focused on prompt/input/output mapping only.",
      "confidence": "high",
      "impact_scope": "subsystem",
      "fix_scope": "architectural_change",
      "root_cause_cluster": "missing_voice_processor_abstraction"
    },
    {
      "dimension": "design_coherence",
      "identifier": "task_payload_mapping_duplicated_front_back",
      "summary": "Task shape normalization logic is duplicated in backend generation and frontend rendering paths.",
      "related_files": [
        "backend/src/workers/voicebot/handlers/createTasksFromChunks.ts",
        "app/src/components/voice/PossibleTasks.tsx"
      ],
      "evidence": [
        "`normalizeTask` and `parseTask` both map the same mixed key variants (`Task ID` vs `task_id_from_ai`, `Task Title` vs `name`, `Priority` vs `priority`, etc.).",
        "Both modules also replicate defaulting behavior (`P3`, generated fallback IDs, default dialogue tag) instead of using one canonical mapper contract.",
        "Schema migration handling is encoded twice (producer + consumer), so future contract updates require synchronized edits in two distant layers."
      ],
      "suggestion": "Define a shared canonical CREATE_TASKS schema/normalizer module (or generated Zod-based contract) used by both worker output and UI parsing so legacy-key support and defaults are maintained in one place.",
      "confidence": "high",
      "impact_scope": "subsystem",
      "fix_scope": "multi_file_refactor",
      "root_cause_cluster": "normalization_logic_scatter"
    },
    {
      "dimension": "design_coherence",
      "identifier": "identity_normalization_scatter",
      "summary": "ID and source-link normalization is reimplemented across CRM/voice modules with no common utility boundary.",
      "related_files": [
        "app/src/pages/operops/taskPageUtils.ts",
        "app/src/components/crm/CRMKanban.tsx",
        "backend/src/voicebot_tgbot/ingressHandlers.ts"
      ],
      "evidence": [
        "`taskPageUtils.ts` and `CRMKanban.tsx` both define local `toLookupValue` variants for string/number/ObjectId-like records.",
        "`taskPageUtils.ts` includes source kind/link inference and Telegram/voice link synthesis while `ingressHandlers.ts` independently rebuilds Telegram/public-link canonicalization rules.",
        "Normalization behavior is distributed between UI and backend helper islands, making consistency accidental rather than enforced."
      ],
      "suggestion": "Extract shared normalization primitives (ID coercion, source kind detection, Telegram/voice link canonicalization) into domain utilities consumed by CRM views and voice ingress, with test vectors for legacy formats.",
      "confidence": "medium",
      "impact_scope": "subsystem",
      "fix_scope": "multi_file_refactor",
      "root_cause_cluster": "normalization_logic_scatter"
    },
    {
      "dimension": "design_coherence",
      "identifier": "ui_components_mix_domain_and_infra",
      "summary": "Major UI components bundle presentation with transport/transformation orchestration, creating hard-to-change multi-responsibility files.",
      "related_files": [
        "app/src/pages/voice/SessionPage.tsx",
        "app/src/pages/voice/SessionsListPage.tsx",
        "app/src/components/voice/TranscriptionTableRow.tsx",
        "app/src/components/voice/MeetingCard.tsx"
      ],
      "evidence": [
        "`SessionPage.tsx` contains low-level image read/resize logic, clipboard event plumbing, API error-to-copy translation, and tab composition in one module.",
        "`SessionsListPage.tsx` mixes query-param protocol parsing, identity filtering normalization, visual-state derivation, and table command UX.",
        "`TranscriptionTableRow.tsx` embeds parsing/normalization utilities (timestamps, segment reconstruction, attachment extraction) that are domain logic rather than row rendering concerns."
      ],
      "suggestion": "Split these into focused hooks/services (`useSessionClipboardUpload`, `sessionListQueryState`, `transcriptionRowModel`) and keep components as render orchestrators over already-normalized view models.",
      "confidence": "high",
      "impact_scope": "module",
      "fix_scope": "multi_file_refactor",
      "root_cause_cluster": "ui_orchestration_overgrowth"
    },
    {
      "dimension": "design_coherence",
      "identifier": "request_transport_logic_duplicated_in_stores",
      "summary": "Transport/proxy request plumbing is duplicated across stores instead of centralized behind one HTTP client boundary.",
      "related_files": [
        "app/src/store/requestStore.ts",
        "app/src/store/permissionsStore.ts",
        "app/src/store/voiceBotStore.ts"
      ],
      "evidence": [
        "`requestStore.ts` and `permissionsStore.ts` each implement their own backend URL resolution and proxy config extraction from `window` + env vars.",
        "Both stores manually perform axios POST transport setup and loading/error/message side effects, but with different headers and endpoint prefix conventions.",
        "`voiceBotStore.ts` already depends on dedicated HTTP helpers (`voicebotHttp`), making the parallel custom request stacks in other stores a design inconsistency."
      ],
      "suggestion": "Standardize store networking through shared HTTP clients (CRM/voice variants if needed) and move URL/proxy/header policy into one transport layer to remove per-store request dialects.",
      "confidence": "high",
      "impact_scope": "subsystem",
      "fix_scope": "multi_file_refactor",
      "root_cause_cluster": "transport_policy_fragmentation"
    },
    {
      "dimension": "authorization_consistency",
      "identifier": "crm-routes-missing-auth-guards",
      "summary": "Several CRM routes are publicly mounted without auth/role middleware while sibling business routes require auth.",
      "related_files": [
        "backend/src/index.ts",
        "backend/src/api/routes/crm/customers.ts",
        "backend/src/api/routes/crm/uploads.ts",
        "backend/src/api/routes/finops/employees.ts"
      ],
      "evidence": [
        "`/api/crm` is mounted directly in backend/src/index.ts with no enclosing auth guard.",
        "backend/src/api/routes/crm/customers.ts defines `/list`, `/create`, `/update` without `authMiddleware`/`requireAdmin`.",
        "backend/src/api/routes/crm/uploads.ts defines `/file` and `/files` upload handlers without auth, unlike finops employees route that uses `authMiddleware`."
      ],
      "suggestion": "Apply a consistent access-control policy at CRM router entry (preferred) or per-route middleware, then explicitly whitelist only intended public endpoints.",
      "confidence": "high",
      "impact_scope": "codebase",
      "fix_scope": "architectural_change",
      "root_cause_cluster": "missing-router-level-security-baseline"
    },
    {
      "dimension": "error_consistency",
      "identifier": "store-error-contract-drift",
      "summary": "Zustand stores use incompatible failure contracts (throw vs swallow vs fallback value), causing ambiguous UI behavior.",
      "related_files": [
        "app/src/store/requestStore.ts",
        "app/src/store/permissionsStore.ts",
        "app/src/store/voiceBotStore.ts"
      ],
      "evidence": [
        "requestStore `api_request`/`sendFile` rethrow errors after setting state.",
        "permissionsStore update actions mostly catch/log/show toast and do not throw, while `loadPermissionsLog` does throw.",
        "permissionsStore `getUserPermissions` returns `[]` on any exception, masking backend failures as valid empty state."
      ],
      "suggestion": "Define one store-level error contract (e.g., always throw typed errors and let callers decide UI messaging) and enforce it across request helpers and store actions.",
      "confidence": "high",
      "impact_scope": "subsystem",
      "fix_scope": "multi_file_refactor",
      "root_cause_cluster": "uncentralized-frontend-error-policy"
    },
    {
      "dimension": "convention_outlier",
      "identifier": "permissions-endpoint-prefix-drift",
      "summary": "A single permissions API call uses a different route prefix than all sibling calls, likely breaking that path.",
      "related_files": [
        "app/src/store/permissionsStore.ts",
        "backend/src/api/routes/voicebot/permissions.ts"
      ],
      "evidence": [
        "permissionsStore uses `voicebot/permissions/...` for most calls, but `getUserPermissions` calls `permissions/users/permissions`.",
        "Backend route is documented/implemented under voicebot permissions router (`POST /permissions/users/permissions`) and is mounted under `/api/voicebot` path family."
      ],
      "suggestion": "Normalize `getUserPermissions` to the same `voicebot/permissions/users/permissions` prefix and add a small request path unit/integration test for this store.",
      "confidence": "high",
      "impact_scope": "module",
      "fix_scope": "single_edit",
      "root_cause_cluster": "endpoint-naming-fragmentation"
    },
    {
      "dimension": "incomplete_migration",
      "identifier": "legacy-botcommands-test-stub-active",
      "summary": "Legacy bot-command test API is still a TODO stub while frontend continues to treat it as a functional feature.",
      "related_files": [
        "backend/src/api/routes/crm/legacy/botcommands.ts",
        "backend/src/api/routes/crm/index.ts",
        "app/src/store/kanbanStore.ts"
      ],
      "evidence": [
        "legacy `botcommands.ts` endpoint `/test` has `TODO: Implement actual command testing logic` and returns placeholder payload.",
        "CRM index router mounts `legacy/botcommands` in active API surface.",
        "kanbanStore `testBotCommand` calls `bot-commands/test` and stores result for user-facing flow."
      ],
      "suggestion": "Either implement real command test execution with validated output contract or remove/feature-flag the frontend action until migration is complete.",
      "confidence": "high",
      "impact_scope": "subsystem",
      "fix_scope": "multi_file_refactor",
      "root_cause_cluster": "legacy-route-still-canonical"
    },
    {
      "dimension": "incomplete_migration",
      "identifier": "upload-contract-old-new-coexistence",
      "summary": "Frontend upload helper still assumes a legacy string response while backend now returns structured file objects.",
      "related_files": [
        "app/src/store/requestStore.ts",
        "app/src/store/kanbanStore.ts",
        "backend/src/api/routes/crm/uploads.ts"
      ],
      "evidence": [
        "requestStore `sendFile` is typed as `Promise<string>` and returns `response.data` directly.",
        "crm uploads backend returns `{ success, file: { ..., url } }` (single) and `{ success, files: [...] }` (multi).",
        "kanbanStore `uploadFile` concatenates `backendUrl + relative_url`, assuming `relative_url` is a path string."
      ],
      "suggestion": "Unify upload contract by returning a typed object from `sendFile` and updating consumers to read `file.url` explicitly; add a type-safe DTO for CRM upload responses.",
      "confidence": "high",
      "impact_scope": "subsystem",
      "fix_scope": "multi_file_refactor",
      "root_cause_cluster": "legacy-api-contract-carryover"
    },
    {
      "dimension": "ai_generated_debt",
      "identifier": "repetitive-catch-toast-boilerplate",
      "summary": "Repeated copy-pattern catch/log/toast blocks inflate noise and make behavior drift easy.",
      "related_files": [
        "app/src/store/voiceBotStore.ts",
        "app/src/store/permissionsStore.ts",
        "app/src/store/requestStore.ts"
      ],
      "evidence": [
        "voiceBotStore contains many near-identical catch blocks with localized error strings and `console.error` calls.",
        "permissionsStore repeats almost identical error handling for each update/load action.",
        "requestStore manually duplicates loading/error boilerplate in `api_request` and `sendFile`."
      ],
      "suggestion": "Introduce shared request wrappers (typed success/error handlers with optional toast policy) and remove duplicated per-action catch scaffolding.",
      "confidence": "medium",
      "impact_scope": "subsystem",
      "fix_scope": "multi_file_refactor",
      "root_cause_cluster": "uncentralized-frontend-error-policy"
    },
    {
      "dimension": "cross_module_architecture",
      "identifier": "duplicated_voicebot_transport_stack",
      "summary": "Voice/CRM transport config is duplicated across stores, causing boundary drift",
      "related_files": [
        "app/src/store/requestStore.ts",
        "app/src/store/permissionsStore.ts",
        "app/src/store/voicebotRuntimeConfig.ts",
        "app/src/store/voiceBotStore.ts"
      ],
      "evidence": [
        "`requestStore.ts` and `permissionsStore.ts` each reimplement runtime backend/proxy lookup logic already present in `voicebotRuntimeConfig.ts`.",
        "`voiceBotStore.ts` bypasses `voicebotHttp` in multiple actions (direct `axios.post` and direct `fetch`), creating multiple networking paths in one subsystem."
      ],
      "suggestion": "Create a single typed HTTP runtime module (`store/http/runtime.ts`) that owns backend/proxy/auth header resolution and request execution. Move `getBackendUrl/getProxyConfig` there, make `requestStore`, `permissionsStore`, and `voiceBotStore` call only that layer, then remove direct transport code from store actions.",
      "confidence": "high",
      "impact_scope": "subsystem",
      "fix_scope": "multi_file_refactor",
      "root_cause_cluster": "transport_fragmentation"
    },
    {
      "dimension": "api_surface_coherence",
      "identifier": "permissions_endpoint_family_mismatch",
      "summary": "Permissions API paths are inconsistent for sibling operations",
      "related_files": [
        "app/src/store/permissionsStore.ts",
        "app/src/store/voiceBotStore.ts"
      ],
      "evidence": [
        "`permissionsStore.ts` uses `voicebot/permissions/users/permissions` for updates but `permissions/users/permissions` for reads (`getUserPermissions`).",
        "Neighboring voicebot calls consistently use `voicebot/...` prefixes, so this one-off route shape is hard to reason about and easy to break."
      ],
      "suggestion": "Define endpoint constants for permission routes and use them for both read/update paths. If backend intentionally exposes both paths, keep one canonical constant and add a temporary fallback with telemetry before deleting the alias.",
      "confidence": "high",
      "impact_scope": "module",
      "fix_scope": "single_edit",
      "root_cause_cluster": "transport_fragmentation"
    },
    {
      "dimension": "convention_outlier",
      "identifier": "store_naming_drift_and_typos",
      "summary": "Public store API names drift from project conventions via typo and snake_case islands",
      "related_files": [
        "app/src/store/requestStore.ts",
        "app/src/store/voiceBotStore.ts",
        "app/src/store/crmStore.ts",
        "app/src/store/kanbanStore.ts"
      ],
      "evidence": [
        "Snake_case public method `api_request` in `requestStore.ts` diverges from the camelCase convention used in most stores.",
        "Multiple typo identifiers are exposed in state/action surfaces: `voiceMesagesData`, `secitionsToSync`, `editTiketProject`, `fetchPeformersMarginData`, and payload field `satuses`."
      ],
      "suggestion": "Run a staged rename: add camelCase aliases first, update all callers, then remove legacy names. Use `rg`-driven codemod pass for each symbol and enforce with a naming lint rule for store API members.",
      "confidence": "high",
      "impact_scope": "module",
      "fix_scope": "multi_file_refactor",
      "root_cause_cluster": "legacy_crm_carryover"
    },
    {
      "dimension": "error_consistency",
      "identifier": "mixed_failure_contracts_in_store_actions",
      "summary": "Store actions use incompatible error semantics (throw vs swallow vs fallback values)",
      "related_files": [
        "app/src/store/voiceBotStore.ts",
        "app/src/store/permissionsStore.ts",
        "app/src/store/authStore.ts",
        "app/src/store/projectsStore.ts"
      ],
      "evidence": [
        "`voiceBotStore.ts` mixes patterns: `sendSessionToCrm` throws, `updateSessionName` logs and returns void, `fetchPersonsList` returns `[]` on errors.",
        "`permissionsStore.ts` methods mostly swallow errors with toasts; `loadPermissionsLog` throws after toasting; `getUserPermissions` silently returns empty array.",
        "`authStore.ts` `logout` intentionally ignores request failures, which differs from strict propagation in other auth methods."
      ],
      "suggestion": "Adopt one per-layer rule: data actions return `Result<T, E>` (or throw consistently) and UI layer decides toast behavior. Extract shared `handleStoreError` to normalize logging/context and avoid silent fallbacks for data reads unless explicitly modeled.",
      "confidence": "high",
      "impact_scope": "subsystem",
      "fix_scope": "multi_file_refactor",
      "root_cause_cluster": "transport_fragmentation"
    },
    {
      "dimension": "incomplete_migration",
      "identifier": "legacy_kanban_migration_leftovers",
      "summary": "Migration residue remains in active CRM stores, including unfinished operations",
      "related_files": [
        "app/src/store/kanbanStore.ts",
        "app/src/store/crmStore.ts",
        "app/src/store/projectsStore.ts"
      ],
      "evidence": [
        "Files still carry migration headers from `appkanban`, and `kanbanStore.ts` contains active `// TODO: implement` for `deleteIncomeRow`.",
        "Large use of loose `unknown` payloads in migrated sections indicates incomplete typing hardening of the old surface."
      ],
      "suggestion": "Create a migration-closure task for CRM stores: implement `deleteIncomeRow`, replace `unknown` API payloads with typed response interfaces, and remove migration-header comments once parity and typing checks pass.",
      "confidence": "high",
      "impact_scope": "module",
      "fix_scope": "multi_file_refactor",
      "root_cause_cluster": "legacy_crm_carryover"
    },
    {
      "dimension": "abstraction_fitness",
      "identifier": "god_store_aggregation_reduces_abstraction_value",
      "summary": "Very large stores combine unrelated responsibilities and dilute abstraction benefits",
      "related_files": [
        "app/src/store/voiceBotStore.ts",
        "app/src/store/kanbanStore.ts",
        "app/src/store/sessionsUIStore.ts"
      ],
      "evidence": [
        "`voiceBotStore.ts` includes transport orchestration, websocket lifecycle, data normalization, file upload logic, and UI message side-effects in one object.",
        "`kanbanStore.ts` combines board CRUD, finances, payments, bot commands, imports, and analytics widgets in a single store boundary."
      ],
      "suggestion": "Split into domain slices with explicit ownership: for voice (`voiceSessionData`, `voiceSocket`, `voiceCatalog`, `voiceActions`) and CRM (`kanbanTickets`, `kanbanFinance`, `kanbanAutomation`). Keep each slice exposing focused interfaces and move pure transformation logic to `app/src/store/shared/*` utilities.",
      "confidence": "high",
      "impact_scope": "subsystem",
      "fix_scope": "architectural_change",
      "root_cause_cluster": "store_overgrowth"
    },
    {
      "dimension": "package_organization",
      "identifier": "flat_store_folder_mixes_domains",
      "summary": "Single flat `store/` directory mixes unrelated domains and hides ownership boundaries",
      "related_files": [
        "app/src/store/voiceBotStore.ts",
        "app/src/store/kanbanStore.ts",
        "app/src/store/authStore.ts",
        "app/src/store/fxStore.ts"
      ],
      "evidence": [
        "Holistic structure shows 20 files / 6336 LOC in one flat folder with mixed domains and low avg fan-in (0.7), indicating weak cohesion.",
        "Voicebot, CRM, auth, MCP, and FinOps stores are co-located despite independent change cadences and responsibilities."
      ],
      "suggestion": "Staged reorg plan: (1) create `app/src/store/{voicebot,crm,finops,core,shared}`; (2) move leaf files first (`fxStore`, `fundStore`, `monthCloseStore`, `notificationStore`) then medium stores (`projectsStore`, `crmStore`, `permissionsStore`) then heavy stores (`voiceBotStore`, `kanbanStore`); (3) add temporary barrel exports in old paths for one PR; (4) migrate imports and remove temporary barrels. Validation commands: `cd app && rg -n \"from '../store/|from './store/|from '.*store/\" src`, then `cd app && npm run build`, then `cd app && npm run test`.",
      "confidence": "high",
      "impact_scope": "subsystem",
      "fix_scope": "architectural_change",
      "root_cause_cluster": "store_overgrowth"
    },
    {
      "dimension": "design_coherence",
      "identifier": "duplicated_mcp_session_title_flow",
      "summary": "MCP title-generation flow is duplicated across stores instead of shared",
      "related_files": [
        "app/src/store/sessionsUIStore.ts",
        "app/src/store/voiceBotStore.ts",
        "app/src/store/voicebotRuntimeConfig.ts"
      ],
      "evidence": [
        "`sessionsUIStore.ts` `generateSessionTitle` reimplements MCP URL resolution and message-text extraction patterns already present in `voiceBotStore.ts` flows.",
        "The duplication increases divergence risk for timeout, parsing, and fallback behavior."
      ],
      "suggestion": "Extract shared helpers for MCP server URL resolution and transcription-to-prompt payload generation into `voicebotRuntimeConfig`/`voicebotHttp` adjacent utility module, then call from both stores.",
      "confidence": "high",
      "impact_scope": "module",
      "fix_scope": "multi_file_refactor",
      "root_cause_cluster": "store_overgrowth"
    }
  ],
  "review_quality": {
    "batch_count": 7,
    "dimension_coverage": 0.308,
    "evidence_density": 1.882,
    "high_score_missing_issue_note": 0,
    "finding_pressure": 81.916,
    "dimensions_with_findings": 13
  },
  "review_scope": {
    "reviewed_files_count": 97,
    "successful_batch_count": 7,
    "full_sweep_included": true,
    "total_files": 20,
    "imported_dimensions": [
      "abstraction_fitness",
      "ai_generated_debt",
      "api_surface_coherence",
      "authorization_consistency",
      "convention_outlier",
      "cross_module_architecture",
      "design_coherence",
      "error_consistency",
      "high_level_elegance",
      "incomplete_migration",
      "low_level_elegance",
      "mid_level_elegance",
      "package_organization"
    ]
  },
  "reviewed_files": [
    "app/src/store/requestStore.ts",
    "app/src/store/sessionsUIStore.ts",
    "app/src/store/permissionsStore.ts",
    "app/src/store/kanbanStore.ts",
    "app/src/store/voicebotRuntimeConfig.ts",
    "app/src/store/voiceBotStore.ts",
    "app/src/store/crmStore.ts",
    "app/src/services/api.ts",
    "app/src/store/authStore.ts",
    "app/src/store/codexTaskTimeline.ts",
    "app/e2e/voice-fab-lifecycle.spec.ts",
    "app/src/components/NotificationsDrawer.tsx",
    "app/src/components/PlanFactGrid.tsx",
    "app/src/components/crm/CRMKanban.tsx",
    "app/src/components/crm/projects/EditProject.tsx",
    "app/src/components/voice/AudioUploader.tsx",
    "app/src/components/voice/Categorization.tsx",
    "app/src/components/voice/MeetingCard.tsx",
    "app/src/components/voice/PossibleTasks.tsx",
    "app/src/components/voice/SessionLog.tsx",
    "app/src/components/voice/TranscriptionTableRow.tsx",
    "app/src/pages/AnalyticsPage.tsx",
    "app/src/pages/PlanFactPage.tsx",
    "app/src/pages/operops/CRMPage.tsx",
    "app/src/pages/operops/FinancesPerformersPage.tsx",
    "app/src/pages/operops/ProjectsTree.tsx",
    "app/src/pages/voice/SessionPage.tsx",
    "app/src/pages/voice/SessionsListPage.tsx",
    "app/src/services/guideDirectoryConfig.tsx",
    "backend/scripts/voicebot-close-inactive-sessions.ts",
    "backend/src/api/routes/voicebot/messageHelpers.ts",
    "backend/src/api/routes/voicebot/permissions.ts",
    "backend/src/api/routes/voicebot/uploads.ts",
    "backend/src/miniapp/routes/index.ts",
    "backend/src/services/voicebot/voicebotWebmDedup.ts",
    "backend/src/voicebot_tgbot/ingressHandlers.ts",
    "backend/src/workers/voicebot/handlers/processingLoop.ts",
    "backend/src/workers/voicebot/handlers/transcribeHandler.ts",
    "miniapp/src/components/ASTrackTime.tsx",
    "app/src/components/BonusesGrid.tsx",
    "app/src/components/crm/CRMCreateEpic.tsx",
    "app/src/components/crm/CRMCreateTicket.tsx",
    "app/src/components/crm/WorkHoursSidebar.tsx",
    "app/src/components/crm/finances/PaymentForm.tsx",
    "app/src/components/crm/projects/EditCustomer.tsx",
    "app/src/components/voice/AccessUsersModal.tsx",
    "app/src/components/voice/AddParticipantModal.tsx",
    "app/src/components/voice/CategorizationStatusColumn.tsx",
    "app/src/constants/crm.ts",
    "app/src/pages/DirectoriesPage.tsx",
    "app/src/pages/directories/AgentsPage.tsx",
    "app/src/pages/directories/EmployeesSalariesPage.tsx",
    "app/src/pages/operops/taskPageUtils.ts",
    "app/src/services/types.ts",
    "app/src/utils/voiceTimeline.ts",
    "backend/scripts/backfill-work-hours-ticket-db-id.ts",
    "backend/scripts/runtime-tag-backfill.ts",
    "backend/scripts/summarize-mcp-watchdog.ts",
    "backend/src/api/middleware/roleGuard.ts",
    "backend/src/api/routes/crm/customers.ts",
    "backend/src/api/routes/crm/legacy/botcommands.ts",
    "backend/src/api/routes/crm/legacy/performerspayments.ts",
    "backend/src/api/routes/crm/legacy/projectgroups.ts",
    "backend/src/api/routes/crm/legacy/projecttree.ts",
    "backend/src/api/routes/crm/uploads.ts",
    "backend/src/api/routes/finops/employees.ts",
    "backend/src/api/routes/voicebot/sessionsSharedUtils.ts",
    "backend/src/services/bdClient.ts",
    "backend/src/services/finopsFxRates.ts",
    "backend/src/services/google/sheets.ts",
    "backend/src/services/reports/jiraStyleReport.ts",
    "backend/src/services/voicebot/voicebotDoneNotify.ts",
    "backend/src/voicebot_tgbot/activeSessionMapping.ts",
    "backend/src/voicebot_tgbot/codexReviewCallbacks.ts",
    "backend/src/workers/voicebot/handlers/allCustomPrompts.ts",
    "backend/src/workers/voicebot/handlers/categorizeHandler.ts",
    "backend/src/workers/voicebot/handlers/createTasksFromChunks.ts",
    "backend/src/workers/voicebot/handlers/createTasksPostprocessing.ts",
    "backend/src/workers/voicebot/handlers/customPrompt.ts",
    "backend/src/workers/voicebot/handlers/finalizationHandler.ts",
    "backend/src/workers/voicebot/handlers/oneCustomPrompt.ts",
    "backend/src/workers/voicebot/handlers/questionsHandler.ts",
    "miniapp/src/components/ASChangeStatus.tsx",
    "miniapp/src/components/OneTicket.tsx",
    "app/src/components/ExpensesGrid.tsx",
    "app/src/components/codex/CodexIssueDetailsCard.tsx",
    "app/src/store/employeeStore.ts",
    "app/src/store/expensesStore.ts",
    "app/src/store/fundStore.ts",
    "app/src/store/fxStore.ts",
    "app/src/store/guideStore.ts",
    "app/src/store/mcpRequestStore.ts",
    "app/src/store/monthCloseStore.ts",
    "app/src/store/notificationStore.ts",
    "app/src/store/planFactStore.ts",
    "app/src/store/projectsStore.ts",
    "app/src/store/voicebotHttp.ts"
  ],
  "provenance": {
    "kind": "blind_review_batch_import",
    "blind": true,
    "runner": "codex",
    "run_stamp": "20260228_150642",
    "created_at": "2026-02-28T15:20:28+00:00",
    "batch_count": 7,
    "batch_indexes": [
      1,
      2,
      3,
      4,
      5,
      6,
      7
    ],
    "packet_path": "/home/strato-space/copilot/.desloppify/review_packet_blind.json",
    "packet_sha256": "999d0e8c4507731133423e46691b5639e0d7c07eda33b15ec4c68ee0b2eca51c"
  },
  "assessment_coverage": {
    "scored_dimensions": [
      "naming_quality",
      "logic_clarity",
      "type_safety",
      "contract_coherence",
      "error_consistency",
      "abstraction_fitness",
      "ai_generated_debt",
      "high_level_elegance",
      "mid_level_elegance",
      "low_level_elegance",
      "cross_module_architecture",
      "initialization_coupling",
      "convention_outlier",
      "dependency_health",
      "test_strategy",
      "api_surface_coherence",
      "authorization_consistency",
      "incomplete_migration",
      "package_organization",
      "design_coherence"
    ],
    "selected_dimensions": [
      "cross_module_architecture",
      "convention_outlier",
      "error_consistency",
      "abstraction_fitness",
      "api_surface_coherence",
      "authorization_consistency",
      "ai_generated_debt",
      "incomplete_migration",
      "package_organization",
      "high_level_elegance",
      "mid_level_elegance",
      "low_level_elegance",
      "design_coherence"
    ],
    "imported_dimensions": [
      "abstraction_fitness",
      "ai_generated_debt",
      "api_surface_coherence",
      "authorization_consistency",
      "convention_outlier",
      "cross_module_architecture",
      "design_coherence",
      "error_consistency",
      "high_level_elegance",
      "incomplete_migration",
      "low_level_elegance",
      "mid_level_elegance",
      "package_organization"
    ],
    "missing_dimensions": [
      "naming_quality",
      "logic_clarity",
      "type_safety",
      "contract_coherence",
      "initialization_coupling",
      "dependency_health",
      "test_strategy"
    ]
  }
}
